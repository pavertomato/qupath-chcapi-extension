steps:
- name: 'gcr.io/cloud-builders/git'
  args:
  - 'clone'
  - 'https://github.com/qupath/qupath.git'
  - 'qupath'
- name: 'gcr.io/cloud-builders/git'
  args:
  - 'checkout'
  - 'tags/v0.2.0-m2'
  dir: 'qupath'
- name: 'bash:5.0.7'
  args:
  - 'sed'
  - '-i'
  - '164a\apply plugin: "maven"'
  - '/workspace/qupath/build.gradle'
- name: 'gradle:5.4.1-jdk11'
  volumes:
  - name: 'vol1'
    path: '/root/.m2'
  args:
  - 'gradle'
  - 'install'
  dir: 'qupath'
- name: 'bash:5.0.7'
  volumes:
  - name: 'vol1'
    path: '/root/.m2'
  args:
  - 'cp'
  - '-r'
  - '/workspace/qupath/maven/repo/org'
  - '/root/.m2/repository'
- name: 'maven:3.6.1-jdk-11'
  volumes:
  - name: 'vol1'
    path: '/root/.m2'
  args:
  - 'mvn'
  - 'install'
- name: 'google/cloud-sdk:251.0.0'
  args:
  - 'bash'
  - './release/githubRelease.sh'
  - '$REPO_NAME'
  - '$TAG_NAME'
  secretEnv:
  - 'ACCESS_TOKEN'
timeout: 600s
secrets:
- kmsKeyName: projects/healthcare-api-215503/locations/global/keyRings/test1/cryptoKeys/test1
  secretEnv:
    ACCESS_TOKEN: CiQA9wyr22+2xni8cBEik0ps73qyR+OuZdolz5/Rh3OoPqFysLgSUQDxO4tcUUvhrJVYE0W+Z2H3t4xBObj1VI8UaKJklvz+q9axajYZKOe+wsn4zcELiDHg0p8T1Q6lllPOgYWaO1mSNIg/+8cBjlkMJGNYwERblg==